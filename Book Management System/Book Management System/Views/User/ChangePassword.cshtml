@model Book_Management_System.Models.Account
@{
    ViewBag.Title = "ChangePassword";
    Layout = "~/Views/Shared/LayoutUser.cshtml";
}
<div class="main_content">
    <div class="sidebar_title">
        <h3>Change password</h3>
        <hr />
    </div>
    <div class="row">
        <div class="col-md-12">
            @using (Html.BeginForm("ChangePassword", "User", FormMethod.Post, new { @id = "change-password-user" }))
            {
                @Html.AntiForgeryToken()
                <div class="form-horizontal">

                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    @Html.HiddenFor(model => model.Id)
                    @Html.HiddenFor(model => model.IdRole)
                    @Html.HiddenFor(model => model.IsActive)
                    @Html.HiddenFor(model => model.UserName)

                    <div class="form-group">
                        <label class="col-md-3 control-label">New password: </label>
                        <div class="col-md-8">
                            @Html.EditorFor(model => model.Password, new { htmlAttributes = new { @class = "form-control", @type = "password", @placeholder = "6-30 characters" } })
                            @Html.ValidationMessageFor(model => model.Password, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-md-3">Confirm password: </label>
                        <div class="col-md-8">
                            @Html.Editor("Confirm_Password", new { htmlAttributes = new { @class = "form-control", @type = "password", @placeholder = "6-30 characters" } })
                            @Html.ValidationMessageFor(model => model.Password, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-offset-3 col-md-9">
                            <input type="submit" value="Save" class="btn btn-success" />
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>
<!--Script-->
@section Js {
<script type="text/javascript">
    $(document).ready(function () {
        $('#change-password-user').bootstrapValidator({
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                Password: {
                    validators: {
                        notEmpty: {
                            message: "Password can not be empty"
                        },
                        stringLength: {
                            min: 6,
                            max: 30,
                            message: 'Password must have at least 6 and less than 30 characters'
                        },
                        regexp: {
                            regexp: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z0-9\S]{6,30}$/,
                            message: 'Password must be 6-30 characters, at least one uppercase letter, one lowercase letter, one number and no whitespace (special characters are allowed)'
                        }
                    }
                },
                Confirm_Password: {
                    validators: {
                        stringLength: {
                            min: 6,
                            max: 30,
                            message: 'Confirm password must have at least 6 characters'
                        },
                        notEmpty: {
                            message: "Confirm password can not be empty"
                        },
                        identical: {
                            field: 'Password',
                            message: 'Password does not match'
                        }
                    }
                }
            }
        })
    })
</script>   }

